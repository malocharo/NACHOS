<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nachos: OpenFileTable Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nachos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_open_file_table-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OpenFileTable Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="oftable_8h_source.html">oftable.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for OpenFileTable:</div>
<div class="dyncontent">
<div class="center"><img src="class_open_file_table__coll__graph.png" border="0" usemap="#_open_file_table_coll__map" alt="Collaboration graph"/></div>
<map name="_open_file_table_coll__map" id="_open_file_table_coll__map">
<area shape="rect" id="node2" href="class_lock.html" title="Defines the &quot;lock&quot; synchronization tool. " alt="" coords="225,1384,406,1551"/>
<area shape="rect" id="node15" href="class_open_file_table_entry.html" title="defines the structure of a record in the open file table " alt="" coords="416,1612,583,1739"/>
<area shape="rect" id="node3" href="class_thread.html" title="Data structures for managing threads. " alt="" coords="235,1089,396,1323"/>
<area shape="rect" id="node4" href="structsimulator_context_t.html" title="Defines the context of the Nachos simulator. " alt="" coords="146,875,275,975"/>
<area shape="rect" id="node5" href="class_process.html" title="Defines the data structures to keep track of the execution environment of a user program. " alt="" coords="396,868,504,981"/>
<area shape="rect" id="node9" href="class_addr_space.html" title="Defines the data structures to keep track of memory resources of executing user programs (address spa..." alt="" coords="486,1116,655,1296"/>
<area shape="rect" id="node6" href="class_process_stat.html" title="Defines statistics that concern a particular process. " alt="" coords="359,393,541,760"/>
<area shape="rect" id="node7" href="class_open_file.html" title="Defines the data structure maintained when a file is opened. " alt="" coords="570,447,698,707"/>
<area shape="rect" id="node12" href="structs__mapped__file.html" title="Information describing a memory&#45;mapped file. " alt="" coords="580,881,689,968"/>
<area shape="rect" id="node8" href="class_file_header.html" title="Defines a file header in the Nachos file system. " alt="" coords="559,5,710,332"/>
<area shape="rect" id="node10" href="class_translation_table.html" title="Defines the data structures used for address translation. " alt="" coords="780,821,931,1028"/>
<area shape="rect" id="node11" href="class_page_table_entry.html" title="Defines an entry in a simple translation table. " alt="" coords="788,487,924,667"/>
<area shape="rect" id="node13" href="structthread_context_t.html" title="Defines the thread context (MIPS virtual machine) " alt="" coords="5,875,122,975"/>
<area shape="rect" id="node14" href="class_list.html" title="Definition of a generic single&#45;linked &quot;list&quot;. " alt="" coords="80,1089,210,1323"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adfdc39f363a64df2baad46e55585c3c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#adfdc39f363a64df2baad46e55585c3c2">OpenFileTable</a> ()</td></tr>
<tr class="separator:adfdc39f363a64df2baad46e55585c3c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa873f9da16a0f3985d45124c3e81a561"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#aa873f9da16a0f3985d45124c3e81a561">~OpenFileTable</a> ()</td></tr>
<tr class="separator:aa873f9da16a0f3985d45124c3e81a561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0519dd960600e61b98d524281aaa882"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_open_file.html">OpenFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#ab0519dd960600e61b98d524281aaa882">Open</a> (char *name)</td></tr>
<tr class="separator:ab0519dd960600e61b98d524281aaa882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e66618c4c336c7292ca9496bacf27b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a03e66618c4c336c7292ca9496bacf27b">Close</a> (char *name)</td></tr>
<tr class="separator:a03e66618c4c336c7292ca9496bacf27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42a3aba7c0ffc5d08c4a6be61a22fc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#ad42a3aba7c0ffc5d08c4a6be61a22fc1">FileLock</a> (char *name)</td></tr>
<tr class="separator:ad42a3aba7c0ffc5d08c4a6be61a22fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addfa5b75bab09266fea5d13fb50474ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#addfa5b75bab09266fea5d13fb50474ab">FileRelease</a> (char *name)</td></tr>
<tr class="separator:addfa5b75bab09266fea5d13fb50474ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004541913ef8deb24d571c20d2020175"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a004541913ef8deb24d571c20d2020175">Remove</a> (char *name)</td></tr>
<tr class="separator:a004541913ef8deb24d571c20d2020175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b64dcb8c4bd7aa0cc77364afd344532"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a6b64dcb8c4bd7aa0cc77364afd344532">next_entry</a> ()</td></tr>
<tr class="separator:a6b64dcb8c4bd7aa0cc77364afd344532"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a46f545547c16a6a8f9cf032a41bd900b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_lock.html">Lock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a46f545547c16a6a8f9cf032a41bd900b">createLock</a></td></tr>
<tr class="separator:a46f545547c16a6a8f9cf032a41bd900b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4e7b645c9b53a31441605fe70e9ae345"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a4e7b645c9b53a31441605fe70e9ae345">findl</a> (char *name)</td></tr>
<tr class="separator:a4e7b645c9b53a31441605fe70e9ae345"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a064d387b506b044afb9d8179907c24dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_open_file_table_entry.html">OpenFileTableEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a064d387b506b044afb9d8179907c24dc">table</a> [<a class="el" href="oftable_8h.html#a6a9c3d9cb0fa1bf8e377de51d8e14fd0">NBOFTENTRY</a>]</td></tr>
<tr class="separator:a064d387b506b044afb9d8179907c24dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e62f56dadf6aaf623377dea1504d8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file_table.html#a78e62f56dadf6aaf623377dea1504d8e">nbentry</a></td></tr>
<tr class="separator:a78e62f56dadf6aaf623377dea1504d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a list of all opened files the class <a class="el" href="class_open_file_table.html" title="Defines a list of all opened files the class OpenFileTable maintain a list of all the open files in n...">OpenFileTable</a> maintain a list of all the open files in nachos and provides synchronisation between several threads wich use the same file. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adfdc39f363a64df2baad46e55585c3c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfdc39f363a64df2baad46e55585c3c2">&#9670;&nbsp;</a></span>OpenFileTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenFileTable::OpenFileTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>initialize the open file table. </p>

</div>
</div>
<a id="aa873f9da16a0f3985d45124c3e81a561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa873f9da16a0f3985d45124c3e81a561">&#9670;&nbsp;</a></span>~OpenFileTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenFileTable::~OpenFileTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>initialize the open file table. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a03e66618c4c336c7292ca9496bacf27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e66618c4c336c7292ca9496bacf27b">&#9670;&nbsp;</a></span>Close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFileTable::Close </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>decrease numthread and if numthread is 0 then remove the file from the open file table</p>
<p>called when a thread closes a file : this method decrease numthread and if it is null then the entry is deleted. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file to close </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad42a3aba7c0ffc5d08c4a6be61a22fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42a3aba7c0ffc5d08c4a6be61a22fc1">&#9670;&nbsp;</a></span>FileLock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFileTable::FileLock </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>lock the file name to implement atomic write</p>
<p><a class="el" href="class_lock.html" title="Defines the &quot;lock&quot; synchronization tool. ">Lock</a> the access to a file. It is used to synchronise reads and writes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file we want to lock </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="addfa5b75bab09266fea5d13fb50474ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addfa5b75bab09266fea5d13fb50474ab">&#9670;&nbsp;</a></span>FileRelease()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFileTable::FileRelease </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>release the lock after the disk operation. </p>
<p>release the lock after the disk operation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file we want to unlock </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4e7b645c9b53a31441605fe70e9ae345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e7b645c9b53a31441605fe70e9ae345">&#9670;&nbsp;</a></span>findl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFileTable::findl </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>find a file in the table return</p>
<dl class="section return"><dt>Returns</dt><dd>-1 if the file is not in the table or its place in the table if it was already opened </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file we want to find </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6b64dcb8c4bd7aa0cc77364afd344532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b64dcb8c4bd7aa0cc77364afd344532">&#9670;&nbsp;</a></span>next_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFileTable::next_entry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this function give the next valid entry in the table </p>
<p>this function looks in the table where it is possible to add a new entry</p>
<dl class="section return"><dt>Returns</dt><dd>the next valid entry in the table </dd></dl>

</div>
</div>
<a id="ab0519dd960600e61b98d524281aaa882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0519dd960600e61b98d524281aaa882">&#9670;&nbsp;</a></span>Open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_open_file.html">OpenFile</a> * OpenFileTable::Open </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>check if the file is already open and if not creates a new entry in the table</p>
<p>check if the file is already open and if not creates a new entry in the table.</p>
<dl class="section return"><dt>Returns</dt><dd>the open file </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file </td></tr>
    <tr><td class="paramname">file</td><td>is an Openfile object to strore in the table </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a004541913ef8deb24d571c20d2020175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004541913ef8deb24d571c20d2020175">&#9670;&nbsp;</a></span>Remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFileTable::Remove </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>remove the file from the file system </p>
<p>remove the file from the directory and put ToBeDeleted to true. after removing a file nobody can open the deleted file but every thread wich has it open can access the datas. The data on disk will be deleted only after every thread had closed this file.</p>
<dl class="section return"><dt>Returns</dt><dd>NO_ERROR if the file has been successfuly removed </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>is the name of the file we want to delete </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a46f545547c16a6a8f9cf032a41bd900b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46f545547c16a6a8f9cf032a41bd900b">&#9670;&nbsp;</a></span>createLock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_lock.html">Lock</a>* OpenFileTable::createLock</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a78e62f56dadf6aaf623377dea1504d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78e62f56dadf6aaf623377dea1504d8e">&#9670;&nbsp;</a></span>nbentry</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFileTable::nbentry</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the number of the next valid entry in the table </p>

</div>
</div>
<a id="a064d387b506b044afb9d8179907c24dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064d387b506b044afb9d8179907c24dc">&#9670;&nbsp;</a></span>table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_open_file_table_entry.html">OpenFileTableEntry</a>* OpenFileTable::table[<a class="el" href="oftable_8h.html#a6a9c3d9cb0fa1bf8e377de51d8e14fd0">NBOFTENTRY</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the list of open files </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>filesys/<a class="el" href="oftable_8h_source.html">oftable.h</a></li>
<li>filesys/<a class="el" href="oftable_8cc.html">oftable.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
